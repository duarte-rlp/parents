{% extends "global/Page.html" %}
{% load otree static %}

{% block scripts %}
    <link href="{% static 'checker1/css/styles.css' %}" rel="stylesheet">
    <script src="{% static 'checker1/js/functions.js' %}"></script>

    <script>
        var start;
        var end;
        var cnt_errors = 0;

        function validateColor() {
            var rad_col = document.getElementsByName("response_checker");
            if(Array.from(rad_col).find(radio => radio.checked).value == "{{ correct_color }}") {
                end = Date.now();
                let time_check = document.getElementById("time_checker");
                // guardamos el tiempo que demoró en dar la respuesta correcta en milisegundos
                time_check.value = end - start; 
                // guardamos la cantidad de errores
                let cnt_mistakes = document.getElementById("cnt_mistakes");
                cnt_mistakes.value = cnt_errors;
                let mistakes = document.getElementById("mistakes_checker");
                mistakes.value += "}";
                let btn = document.getElementById("id_next");
                btn.removeAttribute("disabled");
                btn.click();
            } else {
                cnt_errors += 1;
                let div_error = document.getElementById("div_error");
                div_error.style.display = "block";
                let mistakes = document.getElementById("mistakes_checker");
                let time = Date.now() - start;
                let add = cnt_errors.toString() + ": {\'option\': \'" + Array.from(rad_col).find(radio => radio.checked).value + "\', \'time\': " + time + "}, ";
                mistakes.value += add;
            }
        }

        function restore_error(id_div) {
            let in_answ = document.getElementById(id_div);
            div_error.style.display = "none";
            in_answ.style.boxShadow = "none";
        }

        window.onload = function(){
            start = Date.now();
        };
    </script>
{% endblock %}

{% block title %}
    Parte 1 - Chequeo de Atención
{% endblock %}

{% block content %}

La siguiente pregunta se refiere al siguiente problema. En cuestionarios como el nuestro, a veces hay participantes que no leen atentamente las preguntas y se limitan a hacer clic rápidamente en la encuesta. Esto significa que hay muchas respuestas aleatorias que comprometen los resultados de los estudios de investigación. Para demostrar que ha leído atentamente nuestras preguntas, responda a la siguiente pregunta con la palabra 'turquesa'. ¿Cuál es su color favorito?

<br><br>
<input type="radio" class="radios" name="response_checker" onchange="restore_error('div_error')" value="{{ colors.0 }}">{{ colors.0 }}
<br>
<input type="radio" class="radios" name="response_checker" onchange="restore_error('div_error')" value="{{ colors.1 }}">{{ colors.1 }}
<br>
<input type="radio" class="radios" name="response_checker" onchange="restore_error('div_error')" value="{{ colors.2 }}">{{ colors.2 }}
<br>
<input type="radio" class="radios" name="response_checker" onchange="restore_error('div_error')" value="{{ colors.3 }}">{{ colors.3 }}
<br>

<input type="hidden" name="cnt_mistakes" value="" id="cnt_mistakes">
<input type="hidden" name="mistakes_checker" value="{ " id="mistakes_checker">
<input type="hidden" name="time_checker" value="" id="time_checker">

<br>

<div class="error_msg" id="div_error">
    Por favor lea atentamente la pregunta y responda de nuevo
</div>

<div class="div_btnNext">
    <input type="button" value="Siguiente" class="btnNext" onclick="validateColor()">
    <button class="otree-btn-next btn btn-primary" style="display: none;" id="id_next" disabled>Siguiente</button>
</div>
{% endblock %}
